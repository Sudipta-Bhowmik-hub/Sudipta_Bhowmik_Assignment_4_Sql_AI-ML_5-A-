Week 4 Assignment.sql 

-----------------------------------------------------------------------------------------------------------------------------------
Name : Sudipta Bhowmik 
Batch : AI/ML 5 (A)
Domain : Artificial Intelligence and Machine Learning 
-----------------------------------------------------------------------------------------------------------------------------------

## Table Creation : 

CREATE TABLE Departments (
    dept_id INT PRIMARY KEY,
    dept_name VARCHAR(50)
);

CREATE TABLE Employees (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(50),
    dept_id INT,
    salary INT,
    joining_date DATE,
    FOREIGN KEY (dept_id) REFERENCES Departments(dept_id)
);

-----------------------------------------------------------------------------------------------------------------------------------

## Insert Data :

INSERT INTO Departments VALUES
(1, 'HR'),
(2, 'IT'),
(3, 'Finance');

INSERT INTO Employees VALUES
(101, 'Amit', 1, 40000, '2022-01-15'),
(102, 'Riya', 2, 60000, '2021-03-10'),
(103, 'Suman', 2, 55000, '2023-06-20'),
(104, 'Rahul', 3, 70000, '2020-09-05'),
(105, 'Neha', 1, 45000, '2022-11-25');
-----------------------------------------------------------------------------------------------------------------------------------

## 'TIME' Function :

SELECT emp_name, joining_date,
       YEAR(joining_date) AS joining_year,
       MONTH(joining_date) AS joining_month,
       DATEDIFF(CURDATE(), joining_date) AS days_in_company
FROM Employees;
------------------------------------------------------------------------------------------------------------------------------------

## 'ROW_NUMBER' :

SELECT emp_name, salary,
       ROW_NUMBER() OVER (ORDER BY salary DESC) AS row_num
FROM Employees;
------------------------------------------------------------------------------------------------------------------------------------

## RANK :

SELECT emp_name, salary,
       RANK() OVER (ORDER BY salary DESC) AS salary_rank
FROM Employees;
------------------------------------------------------------------------------------------------------------------------------------

## DENSE_RANK :

SELECT emp_name, salary,
       DENSE_RANK() OVER (ORDER BY salary DESC) AS dense_salary_rank
FROM Employees;
-------------------------------------------------------------------------------------------------------------------------------------

## PARTITION_BY :

SELECT emp_name, dept_id, salary,
       RANK() OVER (PARTITION BY dept_id ORDER BY salary DESC) AS dept_rank
FROM Employees;
-------------------------------------------------------------------------------------------------------------------------------------

## FIRST_VALUE :

SELECT emp_name, dept_id, salary,
       FIRST_VALUE(emp_name)
       OVER (PARTITION BY dept_id ORDER BY salary DESC) AS highest_paid_employee
FROM Employees;
-------------------------------------------------------------------------------------------------------------------------------------

## PERCENT_RANK :

SELECT emp_name, salary,
       PERCENT_RANK() OVER (ORDER BY salary) AS percent_rank
FROM Employees;
--------------------------------------------------------------------------------------------------------------------------------------
